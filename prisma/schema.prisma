generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        Int        @id @default(autoincrement())
  email     String     @unique
  provider  String
  loginDate DateTime
  Progress  Progress[]

  @@map("users")
}

model Progress {
  itemId  String
  topicId String
  themeId String

  itemStatus  ItemStatus
  elementType ElementType
  modifiedAt  DateTime    @updatedAt

  userId Int
  user   User @relation(fields: [userId], references: [id])

  @@unique([itemId, userId])
}

enum ItemStatus {
  NotStarted
  InProgress
  Completed
}

enum ElementType {
  Video
  Exercise
}

enum ThemeCategory {
  Leveling @map("nivelamento")
  SelfStudy @map("autoestudo")
}

model Theme {
  id               String        @id @default(cuid())
  title            String
  description      String
  shortDescription String
  image            String
  category         ThemeCategory
  sequence         Int           @default(0)
  alt              String

  topic Topic[]

  @@map("themes")
}

model Topic {
  id               String @id @default(cuid())
  title            String
  shortDescription String
  description      String
  references       String

  themeId String?
  theme   Theme?  @relation(fields: [themeId], references: [id])

  exercises Exercise[]
  video   Video?

  @@map("topics")
}

model Exercise {
  id               String @id @default(cuid())
  title            String
  shortDescription String
  description      String
  sequence         Int    @default(0)

  topicId String?
  topic Topic? @relation(fields: [topicId], references: [id])

  @@map("exercises")
}

model Video {
  id          String @id @default(cuid())
  title       String
  description String
  references  String
  link        String @unique

  topicId String? @unique
  topic Topic? @relation(fields: [topicId], references: [id])

  @@map("videos")
}
